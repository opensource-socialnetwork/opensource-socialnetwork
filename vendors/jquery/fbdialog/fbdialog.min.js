(function ($) {
    $.fn.fbdialog = function (options, callback) {

        //Default values
        var defaults = {
            title: "Facebook Dialog",
            cancel: "Cancel",
            okay: "Okay",
            okaybutton: true,
            cancelbutton: true,
            buttons: true,
            opacity: 0.4,
            dialogtop: "378px"
        };
        var fbdialogHtml = '<div class="fb_overlay"><div id="facebook_dialog"><div class="fb_fade"><div class="fb_inner_gray fb_clearfix"><div class="fb_inner_gray_text"></div><div class="fb_inner_gray_close_button"><a href="#" class="fb_close" role="button" title="Close"></a></div></div><div class="fb_inner_body"><div class="fb_inner_body_content"></div><div class="fb_inner_buttons"><button class="fb_okay_button" id="fbokbtn" type="submit" tabindex="0"></button><a href="#" class="fb_cancel_button" id="fbclbtn" role="button"></a></div></div></div></div></div>',
            options = $.extend(defaults, options),
            dat = this.html();
        $("body").append(fbdialogHtml);
        !1 != options.okaybutton && !1 != options.buttons || $("#facebook_dialog #fbokbtn").hide();
        !1 != options.cancelbutton && !1 != options.buttons || $("#facebook_dialog #fbclbtn").hide();
        $("#facebook_dialog .fb_inner_gray_text").append(options.title);
        $("#facebook_dialog #fbokbtn").append(options.okay);
        $("#facebook_dialog #fbclbtn").append(options.cancel);
        $("#facebook_dialog .fb_inner_body_content").append(dat);
        $(".fb_overlay, #facebook_dialog, .fb_fade").css("opacity", 1);
        $(".fb_overlay, .fb_fade").show();
        var fbheight = $(".fb_fade").height();
        $(".fb_overlay, #facebook_dialog").css("opacity", 0);
        $(".fb_overlay, .fb_fade").hide();
        $(".fb_overlay, #facebook_dialog").removeAttr("style");
        $("#facebook_dialog").css("min-height", "90px");
        $(".fb_overlay").show().css("background-color", "rgba(0, 0, 0, " + options.opacity + ")");
        $("#facebook_dialog").css("width", "225").animate({
            opacity: 1,
            height: fbheight,
            width: "448"
        }, 600, function () {
            $(".fb_fade").show()
        });
        $("#facebook_dialog").css("margin-top", options.dialogtop);
        $(".fb_close, #fbokbtn, #fbclbtn").click(function () {
            $(".fb_overlay, #facebook_dialog, .fb_fade").fadeOut("slow", function () {
                $(".fb_overlay, #facebook_dialog").removeAttr("style");
                $("#facebook_dialog, .fb_overlay").remove()
            })
        });
        $("#facebook_dialog #fbokbtn").click(function () {
            callback(1)
        });
        $("#facebook_dialog #fbclbtn").click(function () {
            callback(2)
        });
        !0 == options.close && $(".fb_overlay, #facebook_dialog, .fb_fade").fadeOut("slow", function () {
            $(".fb_overlay, #facebook_dialog").removeAttr("style");
            $("#facebook_dialog, .fb_overlay").remove()
        });
    }
})(jQuery);